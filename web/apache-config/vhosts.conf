# ==============================================================================
# HOSTING CENTRUM - Apache VirtualHosts
#
# TYM WEBSERVER: Pridavejte dalsi VirtualHosty podle potreby.
#
# Architektura:
#   1. Hlavni VirtualHost - reverse proxy na Spring Boot API
#   2. Zakaznicke VirtualHosty - servuji staticky obsah z /srv/customers/
#
# Pro testovani pridejte do /etc/hosts:
#   127.0.0.1   localhost
#   127.0.0.1   www.mojefirma.cz mojefirma.cz
#   127.0.0.1   www.druhafirma.cz druhafirma.cz
#   127.0.0.1   www.tretifirma.cz tretifirma.cz
# ==============================================================================

# ==============================================================================
# HLAVNI VIRTUALHOST - Platforma (API + Frontend)
#
# Vsechny pozadavky jdou na Spring Boot backend.
# TYM FRONTEND: Pokud pouzijete React/Next.js, upravte proxy pravidla.
# ==============================================================================
<VirtualHost *:80>
    ServerName localhost
    ServerAlias hostingcentrum.local

    # --- Logy ---
    ErrorLog /proc/self/fd/2
    CustomLog /proc/self/fd/1 combined

    # --- Reverse Proxy na Spring Boot ---
    ProxyPreserveHost On
    ProxyPass / http://backend:8080/
    ProxyPassReverse / http://backend:8080/

    # --- Timeout pro API ---
    ProxyTimeout 60

    # --- Hlavicky ---
    RequestHeader set X-Forwarded-Proto "http"
    RequestHeader set X-Forwarded-Port "80"
</VirtualHost>

# ==============================================================================
# ZAKAZNICKE VIRTUALHOSTY
#
# Kazdy zakaznik ma svou domenu a slozku v /srv/customers/{user_id}/www/
#
# TYM WEBSERVER: Tyto VirtualHosty jsou pro demonstraci.
# V produkci by se generovaly dynamicky nebo pres .htaccess.
# ==============================================================================

# --- Testovaci zakaznik 1: mojefirma.cz ---
<VirtualHost *:80>
    ServerName www.mojefirma.cz
    ServerAlias mojefirma.cz

    # Slozka zakaznika (namapovana pres Docker volume)
    DocumentRoot /srv/customers/user_2/www

    <Directory /srv/customers/user_2/www>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # Logy
    ErrorLog /proc/self/fd/2
    CustomLog /proc/self/fd/1 combined
</VirtualHost>

# --- Testovaci zakaznik 2: druhafirma.cz ---
<VirtualHost *:80>
    ServerName www.druhafirma.cz
    ServerAlias druhafirma.cz

    DocumentRoot /srv/customers/user_3/www

    <Directory /srv/customers/user_3/www>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    ErrorLog /proc/self/fd/2
    CustomLog /proc/self/fd/1 combined
</VirtualHost>

# --- Testovaci zakaznik 3: tretifirma.cz ---
<VirtualHost *:80>
    ServerName www.tretifirma.cz
    ServerAlias tretifirma.cz

    DocumentRoot /srv/customers/user_4/www

    <Directory /srv/customers/user_4/www>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    ErrorLog /proc/self/fd/2
    CustomLog /proc/self/fd/1 combined
</VirtualHost>
